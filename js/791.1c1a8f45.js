"use strict";(self["webpackChunkserver_reservation"]=self["webpackChunkserver_reservation"]||[]).push([[791],{8791:function(e,t,r){r.r(t),r.d(t,{default:function(){return Ut}});var i=r(6768),s=r(4232),a=r(5130);const n={class:"reservation-calendar-container"},o={class:"reservation-calendar"},l={class:"server-view"},d={class:"week-nav"},c={class:"week-range"},u={class:"filter-container"},v={class:"filter"},h=["title"],m={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"18",height:"18"},g=["fill","stroke"],p={key:0,class:"filter-stats"},f={class:"days-container"},D={class:"day-header"},w={class:"day-title"},y={class:"day-time-axis"},k={class:"content-wrapper"},L={class:"server-labels"},C=["onClick"],S={class:"server-label-content"},T={class:"timeline-container"},b=["onMousedown","data-day-index"],R=["data-server-id","data-server-index"],E=["onMousedown","onDragover","onDrop","data-day-date","data-server-name"],M=["onMousedown"],I={class:"reservation-title"},U={key:0,class:"app-modal-overlay"},x={class:"app-modal"},F={class:"app-modal-content"},P={class:"app-form-group"},_=["value"],X={class:"app-form-group"},$={class:"app-form-group"},A={class:"app-form-group"},O={class:"date-time-row"},H={class:"date-time-group"},Y=["value"],V={class:"date-time-group"},q=["value"],W={class:"app-form-group"},N={class:"date-time-row"},Q={class:"date-time-group"},B=["value"],K={class:"date-time-group"},G=["value"],j={class:"app-form-group"},J={class:"app-modal-footer"},z={key:1,class:"app-modal-overlay"},Z={class:"app-modal"},ee={class:"app-modal-content"},te={class:"app-form-group"},re=["value"],ie={class:"app-form-group"},se={class:"app-form-group"},ae={class:"app-form-group"},ne={class:"date-time-row"},oe={class:"date-time-group"},le=["value"],de={class:"date-time-group"},ce=["value"],ue={class:"app-form-group"},ve={class:"date-time-row"},he={class:"date-time-group"},me=["value"],ge={class:"date-time-group"},pe=["value"],fe={class:"app-form-group"},De={class:"app-modal-footer"},we={key:2,class:"app-modal-overlay"},ye={class:"app-modal"},ke={class:"app-modal-content"},Le={class:"app-form-group"},Ce={class:"info-display"},Se={class:"app-form-group"},Te={class:"info-display"},be={class:"app-form-group"},Re={class:"info-display"},Ee={class:"app-form-group"},Me={class:"info-display"},Ie={class:"app-form-group"},Ue={class:"info-display"},xe={key:0,class:"app-form-group"},Fe={class:"info-display note"},Pe={class:"app-modal-footer"},_e={class:"app-modal server-details-modal"},Xe={class:"app-modal-header"},$e={class:"app-modal-content"},Ae={class:"app-form-group"},Oe={class:"info-display"},He={class:"app-form-group"},Ye={class:"info-display"},Ve={class:"app-form-group"},qe={class:"info-display"},We={class:"app-form-group"},Ne={class:"info-display"},Qe={class:"app-form-group"},Be={class:"info-display"},Ke={key:0,class:"app-form-group"},Ge={class:"info-display"},je={key:1,class:"app-form-group"},Je={class:"info-display"},ze={key:2,class:"app-form-group"},Ze={class:"info-display password-field"},et=["title"],tt={key:3,class:"app-form-group"},rt={class:"info-display bmc-links-container"},it=["href"],st={key:4,class:"app-form-group"},at={class:"info-display"},nt={key:5,class:"app-form-group"},ot={class:"info-display password-field"},lt=["title"],dt={key:6,class:"app-form-group"},ct={class:"info-display"},ut={key:7},vt={class:"attached-devices-list"},ht={class:"device-name"},mt={class:"device-type"},gt={class:"app-form-group"},pt={class:"info-display"},ft={class:"app-form-group"},Dt={class:"info-display"},wt={class:"app-form-group"},yt={class:"info-display"},kt={class:"app-form-group"},Lt={class:"info-display"},Ct={class:"app-modal-footer"};function St(e,t,r,St,Tt,bt){const Rt=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.Lk)("div",n,[(0,i.bF)(Rt,{to:"/home",class:"home-icon-button",title:"Home"},{default:(0,i.k6)(()=>[...t[41]||(t[41]=[(0,i.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"30",height:"30",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[(0,i.Lk)("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),(0,i.Lk)("polyline",{points:"9 22 9 12 15 12 15 22"})],-1)])]),_:1}),(0,i.Lk)("div",o,[(0,i.Lk)("div",l,[(0,i.Lk)("div",d,[(0,i.Lk)("button",{onClick:t[0]||(t[0]=e=>bt.moveWeek(-1))},"<"),(0,i.Lk)("span",c,(0,s.v_)(bt.formatWeekRange(Tt.weekStart)),1),(0,i.Lk)("button",{onClick:t[1]||(t[1]=e=>bt.moveWeek(1))},">")]),(0,i.Lk)("div",u,[(0,i.Lk)("div",v,[t[42]||(t[42]=(0,i.Lk)("label",{for:"unifiedFilter"},"Filter:",-1)),(0,i.bo)((0,i.Lk)("input",{id:"unifiedFilter","onUpdate:modelValue":t[2]||(t[2]=e=>Tt.unifiedFilter=e),placeholder:"Server name, CPU type, or device name",class:"filter-input"},null,512),[[a.Jo,Tt.unifiedFilter]]),bt.currentUserEmail?((0,i.uX)(),(0,i.CE)("button",{key:0,onClick:t[3]||(t[3]=e=>Tt.showOnlyFavorites=!Tt.showOnlyFavorites),class:(0,s.C4)(["favorite-filter-btn",{active:Tt.showOnlyFavorites}]),title:Tt.showOnlyFavorites?"Show all servers":"Show only favorites"},[((0,i.uX)(),(0,i.CE)("svg",m,[(0,i.Lk)("path",{fill:Tt.showOnlyFavorites?"currentColor":"none",stroke:Tt.showOnlyFavorites?"none":"currentColor","stroke-width":"1.5",d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"},null,8,g)]))],10,h)):(0,i.Q3)("",!0),Tt.unifiedFilter||Tt.showOnlyFavorites?((0,i.uX)(),(0,i.CE)("button",{key:1,class:"clear-filter-btn",onClick:t[4]||(t[4]=e=>bt.clearAllFilters()),title:"Clear filter"}," × ")):(0,i.Q3)("",!0)]),Tt.unifiedFilter||Tt.showOnlyFavorites?((0,i.uX)(),(0,i.CE)("div",p,[(0,i.Lk)("div",null,"Showing "+(0,s.v_)(bt.filteredServers.length)+" of "+(0,s.v_)(Tt.serversList.length)+" servers",1)])):(0,i.Q3)("",!0)]),(0,i.Lk)("div",f,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(bt.serverWeekDays,t=>((0,i.uX)(),(0,i.CE)("div",{key:t.date,class:(0,s.C4)(["day-section",{today:bt.isSameDay(t.date,new Date)}])},[(0,i.Lk)("div",D,[(0,i.Lk)("div",w,(0,s.v_)(bt.formatDayHeader(t.date)),1),(0,i.Lk)("div",y,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(bt.axisTimes,e=>((0,i.uX)(),(0,i.CE)("div",{key:e,class:"axis-time"},(0,s.v_)(bt.formatAxisHour(e)),1))),128))])]),(0,i.Lk)("div",k,[(0,i.Lk)("div",L,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(bt.filteredServers,e=>((0,i.uX)(),(0,i.CE)("div",{key:e.id,class:"server-label",onClick:t=>bt.showServerDetails(e)},[(0,i.Lk)("div",S,[(0,i.Lk)("span",{class:(0,s.C4)(["status-dot",bt.getStatusColor(e.status)])},null,2),(0,i.eW)(" "+(0,s.v_)(e.name),1)])],8,C))),128))]),(0,i.Lk)("div",T,[bt.isSameDay(t.date,new Date)?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"current-time-arrow",style:(0,s.Tr)(bt.currentTimeArrowStyle(t.date))},null,4)):(0,i.Q3)("",!0),(0,i.Lk)("div",{class:"timeline",style:(0,s.Tr)({height:bt.filteredServers.length*Tt.rowHeight+"px"}),onMousedown:e=>bt.handleTimelineContainerMousedown(t.date,e),"data-day-index":e.index},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(bt.filteredServers,(e,r)=>((0,i.uX)(),(0,i.CE)("div",{key:e.id,class:"reservation-row",style:(0,s.Tr)({top:r*Tt.rowHeight+"px",height:Tt.rowHeight+"px"}),"data-server-id":e.id,"data-server-index":r},[(0,i.Lk)("div",{class:"reservation-container",onMousedown:(0,a.D$)(r=>bt.handleReservationContainerMousedown(e,t.date,r),["stop"]),onDragover:(0,a.D$)(r=>bt.handleDragOver(r,e,t.date),["prevent"]),onDrop:r=>bt.onDrop(r,e,t.date),"data-day-date":t.date.toISOString(),"data-server-name":e.name},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(bt.getReservationsForServerAndDay(e,t.date),r=>((0,i.uX)(),(0,i.CE)("div",{key:r.id,class:(0,s.C4)(["reservation",[bt.getUrgencyColorClass(r.urgency),{"my-reservation":bt.isMyReservation(r)}]]),draggable:!1,onMousedown:i=>bt.startCustomDrag(r,e,t.date,i),style:(0,s.Tr)(bt.getReservationStyle(r,t.date))},[(0,i.Lk)("span",I,(0,s.v_)(r.username),1)],46,M))),128)),Tt.dragCreation.active&&bt.isSameDay(Tt.dragCreation.day,t.date)&&Tt.dragCreation.server===e?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"drag-preview",style:(0,s.Tr)(bt.getDragPreviewStyle())},null,4)):(0,i.Q3)("",!0),Tt.draggedReservation&&bt.isDraggingOver(e,t.date)?((0,i.uX)(),(0,i.CE)("div",{key:1,class:"drag-grid-preview",style:(0,s.Tr)(bt.getDragGridPreviewStyle())},null,4)):(0,i.Q3)("",!0)],40,E)],12,R))),128)),bt.isSameDay(t.date,new Date)?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"current-time-line-timeline",style:(0,s.Tr)(bt.currentTimeLineStyle(t.date))},null,4)):(0,i.Q3)("",!0)],44,b)])])],2))),128))])])]),Tt.customDragActive?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"custom-drag-preview",style:(0,s.Tr)(Tt.customDragPreviewStyle)},null,4)):(0,i.Q3)("",!0)]),(0,i.Lk)("button",{class:"floating-add-button",onClick:t[5]||(t[5]=(...e)=>bt.openReservationForm&&bt.openReservationForm(...e))},"+"),Tt.showReservationForm?((0,i.uX)(),(0,i.CE)("div",U,[(0,i.Lk)("div",x,[t[53]||(t[53]=(0,i.Lk)("div",{class:"app-modal-header"},[(0,i.Lk)("h3",null,"Create New Reservation")],-1)),(0,i.Lk)("div",F,[(0,i.Lk)("div",P,[t[44]||(t[44]=(0,i.Lk)("label",{for:"server"},[(0,i.eW)("Server "),(0,i.Lk)("span",{class:"app-required-field"},"*")],-1)),(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>Tt.newReservation.server=e),id:"server",required:""},[t[43]||(t[43]=(0,i.Lk)("option",{value:"",disabled:""},"Select a server",-1)),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(bt.sortedServersList,e=>((0,i.uX)(),(0,i.CE)("option",{key:e.id,value:e.name},(0,s.v_)(e.name),9,_))),128))],512),[[a.u1,Tt.newReservation.server]])]),(0,i.Lk)("div",X,[t[46]||(t[46]=(0,i.Lk)("label",{for:"urgency"},[(0,i.eW)("Urgency "),(0,i.Lk)("span",{class:"app-required-field"},"*")],-1)),(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":t[7]||(t[7]=e=>Tt.newReservation.urgency=e),id:"urgency",required:""},[...t[45]||(t[45]=[(0,i.Fv)('<option value="" disabled>Select urgency level</option><option value="co-run">Co-run</option><option value="exclusive">Exclusive</option><option value="exclusive (urgent)">Exclusive (Urgent)</option><option value="exclusive (may yield)">Exclusive (May Yield)</option>',5)])],512),[[a.u1,Tt.newReservation.urgency]])]),(0,i.Lk)("div",$,[t[47]||(t[47]=(0,i.Lk)("label",{for:"username"},"Username",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[8]||(t[8]=e=>bt.currentUsername=e),id:"username",type:"text",disabled:""},null,512),[[a.Jo,bt.currentUsername]])]),(0,i.Lk)("div",A,[(0,i.Lk)("div",O,[(0,i.Lk)("div",H,[t[48]||(t[48]=(0,i.Lk)("label",{for:"startDate"},[(0,i.eW)("Start Date "),(0,i.Lk)("span",{class:"app-required-field"},"*")],-1)),(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":t[9]||(t[9]=e=>Tt.startDateInput=e),id:"startDate",onChange:t[10]||(t[10]=(...e)=>bt.validateTimes&&bt.validateTimes(...e))},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(bt.startDateChoices,e=>((0,i.uX)(),(0,i.CE)("option",{key:e.label,value:e.label},(0,s.v_)(e.label),9,Y))),128))],544),[[a.u1,Tt.startDateInput]])]),(0,i.Lk)("div",V,[t[49]||(t[49]=(0,i.Lk)("label",{for:"startTime"},[(0,i.eW)("Start Time "),(0,i.Lk)("span",{class:"app-required-field"},"*")],-1)),(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":t[11]||(t[11]=e=>Tt.startTimeInput=e),id:"startTime",onChange:t[12]||(t[12]=(...e)=>bt.validateTimes&&bt.validateTimes(...e))},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(bt.startTimeChoices,e=>((0,i.uX)(),(0,i.CE)("option",{key:e,value:e},(0,s.v_)(e),9,q))),128))],544),[[a.u1,Tt.startTimeInput]])])])]),(0,i.Lk)("div",W,[(0,i.Lk)("div",N,[(0,i.Lk)("div",Q,[t[50]||(t[50]=(0,i.Lk)("label",{for:"endDate"},[(0,i.eW)("End Date "),(0,i.Lk)("span",{class:"app-required-field"},"*")],-1)),(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":t[13]||(t[13]=e=>Tt.endDateInput=e),id:"endDate",onChange:t[14]||(t[14]=(...e)=>bt.validateTimes&&bt.validateTimes(...e))},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(bt.endDateChoices,e=>((0,i.uX)(),(0,i.CE)("option",{key:e.label,value:e.label},(0,s.v_)(e.label),9,B))),128))],544),[[a.u1,Tt.endDateInput]])]),(0,i.Lk)("div",K,[t[51]||(t[51]=(0,i.Lk)("label",{for:"endTime"},[(0,i.eW)("End Time "),(0,i.Lk)("span",{class:"app-required-field"},"*")],-1)),(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":t[15]||(t[15]=e=>Tt.endTimeInput=e),id:"endTime",onChange:t[16]||(t[16]=(...e)=>bt.validateTimes&&bt.validateTimes(...e))},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(bt.endTimeChoices,e=>((0,i.uX)(),(0,i.CE)("option",{key:e,value:e},(0,s.v_)(e),9,G))),128))],544),[[a.u1,Tt.endTimeInput]])])])]),(0,i.Lk)("div",j,[t[52]||(t[52]=(0,i.Lk)("label",{for:"note"},"Note",-1)),(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":t[17]||(t[17]=e=>Tt.newReservation.note=e),id:"note",placeholder:"Add any additional information"},null,512),[[a.Jo,Tt.newReservation.note]])])]),(0,i.Lk)("div",J,[(0,i.Lk)("button",{onClick:t[18]||(t[18]=(...e)=>bt.confirmReservation&&bt.confirmReservation(...e)),class:"app-btn app-btn-primary"},"Create"),(0,i.Lk)("button",{onClick:t[19]||(t[19]=(...e)=>bt.cancelReservation&&bt.cancelReservation(...e)),class:"app-btn app-btn-secondary"},"Cancel")])])])):(0,i.Q3)("",!0),Tt.showEditModal?((0,i.uX)(),(0,i.CE)("div",z,[(0,i.Lk)("div",Z,[t[63]||(t[63]=(0,i.Lk)("div",{class:"app-modal-header"},[(0,i.Lk)("h3",null,"Edit Reservation")],-1)),(0,i.Lk)("div",ee,[(0,i.Lk)("div",te,[t[54]||(t[54]=(0,i.Lk)("label",{for:"server"},[(0,i.eW)("Server "),(0,i.Lk)("span",{class:"app-required-field"},"*")],-1)),(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":t[20]||(t[20]=e=>Tt.editingReservation.server=e),id:"server"},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(bt.sortedServersList,e=>((0,i.uX)(),(0,i.CE)("option",{key:e.id,value:e.name},(0,s.v_)(e.name),9,re))),128))],512),[[a.u1,Tt.editingReservation.server]])]),(0,i.Lk)("div",ie,[t[56]||(t[56]=(0,i.Lk)("label",{for:"urgency"},[(0,i.eW)("Urgency "),(0,i.Lk)("span",{class:"app-required-field"},"*")],-1)),(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":t[21]||(t[21]=e=>Tt.editingReservation.urgency=e),id:"urgency"},[...t[55]||(t[55]=[(0,i.Lk)("option",{value:"co-run"},"Co-run",-1),(0,i.Lk)("option",{value:"exclusive"},"Exclusive",-1),(0,i.Lk)("option",{value:"exclusive (urgent)"},"Exclusive (Urgent)",-1),(0,i.Lk)("option",{value:"exclusive (may yield)"},"Exclusive (May Yield)",-1)])],512),[[a.u1,Tt.editingReservation.urgency]])]),(0,i.Lk)("div",se,[t[57]||(t[57]=(0,i.Lk)("label",{for:"username"},"Username",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[22]||(t[22]=e=>Tt.editingReservation.username=e),id:"username",type:"text",disabled:""},null,512),[[a.Jo,Tt.editingReservation.username]])]),(0,i.Lk)("div",ae,[(0,i.Lk)("div",ne,[(0,i.Lk)("div",oe,[t[58]||(t[58]=(0,i.Lk)("label",{for:"editStartDate"},[(0,i.eW)("Start Date "),(0,i.Lk)("span",{class:"app-required-field"},"*")],-1)),(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":t[23]||(t[23]=e=>Tt.editingReservation.startDate=e),id:"editStartDate",onChange:t[24]||(t[24]=(...e)=>bt.validateEditTimes&&bt.validateEditTimes(...e))},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(bt.editStartDateChoices,e=>((0,i.uX)(),(0,i.CE)("option",{key:e.label,value:e.label},(0,s.v_)(e.label),9,le))),128))],544),[[a.u1,Tt.editingReservation.startDate]])]),(0,i.Lk)("div",de,[t[59]||(t[59]=(0,i.Lk)("label",{for:"editStartTime"},[(0,i.eW)("Start Time "),(0,i.Lk)("span",{class:"app-required-field"},"*")],-1)),(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":t[25]||(t[25]=e=>Tt.editingReservation.startTime=e),id:"editStartTime",onChange:t[26]||(t[26]=(...e)=>bt.validateEditTimes&&bt.validateEditTimes(...e))},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(bt.editStartTimeChoices,e=>((0,i.uX)(),(0,i.CE)("option",{key:e,value:e},(0,s.v_)(e),9,ce))),128))],544),[[a.u1,Tt.editingReservation.startTime]])])])]),(0,i.Lk)("div",ue,[(0,i.Lk)("div",ve,[(0,i.Lk)("div",he,[t[60]||(t[60]=(0,i.Lk)("label",{for:"editEndDate"},[(0,i.eW)("End Date "),(0,i.Lk)("span",{class:"app-required-field"},"*")],-1)),(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":t[27]||(t[27]=e=>Tt.editingReservation.endDate=e),id:"editEndDate",onChange:t[28]||(t[28]=(...e)=>bt.validateEditTimes&&bt.validateEditTimes(...e))},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(bt.editEndDateChoices,e=>((0,i.uX)(),(0,i.CE)("option",{key:e.label,value:e.label},(0,s.v_)(e.label),9,me))),128))],544),[[a.u1,Tt.editingReservation.endDate]])]),(0,i.Lk)("div",ge,[t[61]||(t[61]=(0,i.Lk)("label",{for:"editEndTime"},[(0,i.eW)("End Time "),(0,i.Lk)("span",{class:"app-required-field"},"*")],-1)),(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":t[29]||(t[29]=e=>Tt.editingReservation.endTime=e),id:"editEndTime",onChange:t[30]||(t[30]=(...e)=>bt.validateEditTimes&&bt.validateEditTimes(...e))},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(bt.editEndTimeChoices,e=>((0,i.uX)(),(0,i.CE)("option",{key:e,value:e},(0,s.v_)(e),9,pe))),128))],544),[[a.u1,Tt.editingReservation.endTime]])])])]),(0,i.Lk)("div",fe,[t[62]||(t[62]=(0,i.Lk)("label",{for:"note"},"Note",-1)),(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":t[31]||(t[31]=e=>Tt.editingReservation.note=e),id:"note",placeholder:"Add any additional information"},null,512),[[a.Jo,Tt.editingReservation.note]])])]),(0,i.Lk)("div",De,[(0,i.Lk)("button",{onClick:t[32]||(t[32]=(...e)=>bt.confirmUpdate&&bt.confirmUpdate(...e)),class:"app-btn app-btn-primary"},"Update"),(0,i.Lk)("button",{onClick:t[33]||(t[33]=(...e)=>bt.cancelEdit&&bt.cancelEdit(...e)),class:"app-btn app-btn-secondary"},"Cancel"),(0,i.Lk)("button",{onClick:t[34]||(t[34]=e=>bt.confirmDelete(Tt.editingReservation)),class:"app-btn app-btn-danger"},"Delete")])])])):(0,i.Q3)("",!0),Tt.showViewModal?((0,i.uX)(),(0,i.CE)("div",we,[(0,i.Lk)("div",ye,[t[70]||(t[70]=(0,i.Lk)("div",{class:"app-modal-header"},[(0,i.Lk)("h3",null,"Reservation Information")],-1)),(0,i.Lk)("div",ke,[(0,i.Lk)("div",Le,[t[64]||(t[64]=(0,i.Lk)("label",null,"Server",-1)),(0,i.Lk)("div",Ce,(0,s.v_)(Tt.viewingReservation.server),1)]),(0,i.Lk)("div",Se,[t[65]||(t[65]=(0,i.Lk)("label",null,"Urgency",-1)),(0,i.Lk)("div",Te,(0,s.v_)(Tt.viewingReservation.urgency),1)]),(0,i.Lk)("div",be,[t[66]||(t[66]=(0,i.Lk)("label",null,"Username",-1)),(0,i.Lk)("div",Re,(0,s.v_)(Tt.viewingReservation.username),1)]),(0,i.Lk)("div",Ee,[t[67]||(t[67]=(0,i.Lk)("label",null,"Start",-1)),(0,i.Lk)("div",Me,(0,s.v_)(Tt.viewingReservation.startDate)+" "+(0,s.v_)(Tt.viewingReservation.startTime),1)]),(0,i.Lk)("div",Ie,[t[68]||(t[68]=(0,i.Lk)("label",null,"End",-1)),(0,i.Lk)("div",Ue,(0,s.v_)(Tt.viewingReservation.endDate)+" "+(0,s.v_)(Tt.viewingReservation.endTime),1)]),Tt.viewingReservation&&Tt.viewingReservation.note?((0,i.uX)(),(0,i.CE)("div",xe,[t[69]||(t[69]=(0,i.Lk)("label",null,"Note",-1)),(0,i.Lk)("div",Fe,(0,s.v_)(Tt.viewingReservation.note),1)])):(0,i.Q3)("",!0)]),(0,i.Lk)("div",Pe,[(0,i.Lk)("button",{onClick:t[35]||(t[35]=(...e)=>bt.closeViewModal&&bt.closeViewModal(...e)),class:"app-btn app-btn-secondary"},"Close")])])])):(0,i.Q3)("",!0),Tt.showServerDetailsModal?((0,i.uX)(),(0,i.CE)("div",{key:3,class:"app-modal-overlay",onClick:t[40]||(t[40]=(0,a.D$)((...e)=>bt.closeServerDetails&&bt.closeServerDetails(...e),["self"]))},[(0,i.Lk)("div",_e,[(0,i.Lk)("div",Xe,[(0,i.Lk)("h3",null,"Server Details: "+(0,s.v_)(Tt.activeServer?.name),1)]),(0,i.Lk)("div",$e,[t[90]||(t[90]=(0,i.Lk)("div",{class:"section-divider"},"Basic Information",-1)),(0,i.Lk)("div",Ae,[t[71]||(t[71]=(0,i.Lk)("label",null,"Name",-1)),(0,i.Lk)("div",Oe,(0,s.v_)(Tt.activeServer?.name),1)]),(0,i.Lk)("div",He,[t[72]||(t[72]=(0,i.Lk)("label",null,"CPU Type",-1)),(0,i.Lk)("div",Ye,(0,s.v_)(Tt.activeServer?.cpuType||"N/A"),1)]),(0,i.Lk)("div",Ve,[t[73]||(t[73]=(0,i.Lk)("label",null,"IP Address",-1)),(0,i.Lk)("div",qe,(0,s.v_)(bt.formatIp(Tt.activeServer?.ip)),1)]),(0,i.Lk)("div",We,[t[74]||(t[74]=(0,i.Lk)("label",null,"Owner",-1)),(0,i.Lk)("div",Ne,(0,s.v_)(Tt.activeServer?.owner||"N/A"),1)]),(0,i.Lk)("div",Qe,[t[75]||(t[75]=(0,i.Lk)("label",null,"Status",-1)),(0,i.Lk)("div",Be,(0,s.v_)(bt.formatStatus(Tt.activeServer?.status)),1)]),Tt.activeServer?.location?((0,i.uX)(),(0,i.CE)("div",Ke,[t[76]||(t[76]=(0,i.Lk)("label",null,"Location",-1)),(0,i.Lk)("div",Ge,(0,s.v_)(Tt.activeServer.location),1)])):(0,i.Q3)("",!0),Tt.activeServer?.sudoUser?((0,i.uX)(),(0,i.CE)("div",je,[t[77]||(t[77]=(0,i.Lk)("label",null,"Sudo Username",-1)),(0,i.Lk)("div",Je,(0,s.v_)(Tt.activeServer.sudoUser),1)])):(0,i.Q3)("",!0),Tt.activeServer?.sudoUserPassword&&bt.hasViewPermissions()?((0,i.uX)(),(0,i.CE)("div",ze,[t[79]||(t[79]=(0,i.Lk)("label",null,"Sudo Password",-1)),(0,i.Lk)("div",Ze,[(0,i.eW)((0,s.v_)(bt.isPasswordVisible("sudo")?Tt.activeServer.sudoUserPassword:"••••••••")+" ",1),(0,i.Lk)("button",{class:"toggle-password",onClick:t[36]||(t[36]=e=>bt.togglePasswordVisibility("sudo")),title:bt.isPasswordVisible("sudo")?"Hide sudo password":"Show sudo password"},[...t[78]||(t[78]=[(0,i.Lk)("svg",{viewBox:"0 0 24 24",width:"16",height:"16",stroke:"currentColor",fill:"none"},[(0,i.Lk)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),(0,i.Lk)("circle",{cx:"12",cy:"12",r:"3"})],-1)])],8,et)])])):(0,i.Q3)("",!0),Tt.activeServer?.bmcIp?((0,i.uX)(),(0,i.CE)("div",tt,[t[80]||(t[80]=(0,i.Lk)("label",null,"BMC IP",-1)),(0,i.Lk)("div",rt,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(bt.parseBmcIps(Tt.activeServer.bmcIp),(e,t)=>((0,i.uX)(),(0,i.CE)("a",{key:t,href:`https://${e}`,target:"_blank",rel:"noopener noreferrer",class:"bmc-link"},(0,s.v_)(e),9,it))),128))])])):(0,i.Q3)("",!0),Tt.activeServer?.bmcUser?((0,i.uX)(),(0,i.CE)("div",st,[t[81]||(t[81]=(0,i.Lk)("label",null,"BMC Username",-1)),(0,i.Lk)("div",at,(0,s.v_)(Tt.activeServer.bmcUser),1)])):(0,i.Q3)("",!0),Tt.activeServer?.bmcPassword&&bt.hasViewPermissions()?((0,i.uX)(),(0,i.CE)("div",nt,[t[83]||(t[83]=(0,i.Lk)("label",null,"BMC Password",-1)),(0,i.Lk)("div",ot,[(0,i.eW)((0,s.v_)(bt.isPasswordVisible("bmc")?Tt.activeServer.bmcPassword:"••••••••")+" ",1),(0,i.Lk)("button",{class:"toggle-password",onClick:t[37]||(t[37]=e=>bt.togglePasswordVisibility("bmc")),title:bt.isPasswordVisible("bmc")?"Hide BMC password":"Show BMC password"},[...t[82]||(t[82]=[(0,i.Lk)("svg",{viewBox:"0 0 24 24",width:"16",height:"16",stroke:"currentColor",fill:"none"},[(0,i.Lk)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),(0,i.Lk)("circle",{cx:"12",cy:"12",r:"3"})],-1)])],8,lt)])])):(0,i.Q3)("",!0),Tt.activeServer?.ubuntuVersion?((0,i.uX)(),(0,i.CE)("div",dt,[t[84]||(t[84]=(0,i.Lk)("label",null,"Ubuntu Version",-1)),(0,i.Lk)("div",ct,(0,s.v_)(Tt.activeServer.ubuntuVersion),1)])):(0,i.Q3)("",!0),Tt.serverAttachedDevices&&Tt.serverAttachedDevices.length>0?((0,i.uX)(),(0,i.CE)("div",ut,[t[85]||(t[85]=(0,i.Lk)("div",{class:"section-divider"},"Attached Devices",-1)),(0,i.Lk)("div",vt,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(Tt.serverAttachedDevices,e=>((0,i.uX)(),(0,i.CE)("div",{key:e.id,class:"attached-device"},[(0,i.Lk)("div",ht,(0,s.v_)(e.name),1),(0,i.Lk)("div",mt,(0,s.v_)(e.type||"Unknown"),1)]))),128))])])):(0,i.Q3)("",!0),t[91]||(t[91]=(0,i.Lk)("div",{class:"section-divider"},"System Specifications",-1)),(0,i.Lk)("div",gt,[t[86]||(t[86]=(0,i.Lk)("label",null,"CPU Frequency",-1)),(0,i.Lk)("div",pt,(0,s.v_)(Tt.activeServer?.cpuFreq||"N/A"),1)]),(0,i.Lk)("div",ft,[t[87]||(t[87]=(0,i.Lk)("label",null,"Memory Slots",-1)),(0,i.Lk)("div",Dt,(0,s.v_)(Tt.activeServer?.memorySlots||"N/A"),1)]),(0,i.Lk)("div",wt,[t[88]||(t[88]=(0,i.Lk)("label",null,"DIMM Type",-1)),(0,i.Lk)("div",yt,(0,s.v_)(Tt.activeServer?.dimmType||"N/A"),1)]),(0,i.Lk)("div",kt,[t[89]||(t[89]=(0,i.Lk)("label",null,"Number of DIMMs",-1)),(0,i.Lk)("div",Lt,(0,s.v_)(Tt.activeServer?.numDimms||"N/A"),1)])]),(0,i.Lk)("div",Ct,[(0,i.Lk)("button",{onClick:t[38]||(t[38]=(...e)=>bt.reserveActiveServer&&bt.reserveActiveServer(...e)),class:"app-btn app-btn-primary"},"Reserve"),(0,i.Lk)("button",{onClick:t[39]||(t[39]=(...e)=>bt.closeServerDetails&&bt.closeServerDetails(...e)),class:"app-btn app-btn-secondary"},"Close")])])])):(0,i.Q3)("",!0)],64)}r(4114),r(8111),r(2489),r(116),r(7588),r(1701),r(3579),r(7642),r(8004),r(3853),r(5876),r(2475),r(5024),r(1698);var Tt=r(1560),bt=r(7617),Rt=r(9986),Et={name:"ReservationCalendar",components:{},data(){return{allReservations:[],serversList:[],reservationsCollection:null,serverFilter:"",weekStart:new Date,rowHeight:35,unsubscribeReservations:null,showReservationForm:!1,newReservation:{start:null,end:null,server:"",urgency:"",note:""},startDateInput:"",startTimeInput:"",endDateInput:"",endTimeInput:"",startDateOffset:"",startTimeOffset:"",endDateOffset:"",endTimeOffset:"",showEditModal:!1,editingReservation:null,showViewModal:!1,viewingReservation:null,dragCreation:{active:!1,server:null,day:null,startX:null,currentX:null,containerLeft:null,containerWidth:null,previewLeft:null,previewWidth:null},draggedReservation:null,draggedOriginalServer:null,dragPreviewPosition:{active:!1,server:null,day:null,left:null,width:null,serverIndex:null},customDragActive:!1,customDragReservation:null,customDragStartServer:null,customDragCurrentServer:null,customDragDay:null,customDragPreviewStyle:{},customDragInitialOffset:0,customDragWidth:0,customDragInitialRect:null,customDragStartTime:null,isDragging:!1,dragStartX:0,dragStartY:0,dragThreshold:5,deviceFilter:"",unifiedFilter:"",showServerDetailsModal:!1,activeServer:null,serverAttachedDevices:[],showOnlyFavorites:!1,favoriteServers:new Set,userDocId:null,visiblePasswords:new Set}},computed:{currentUserEmail(){return Tt.j2.currentUser?Tt.j2.currentUser.email:""},currentUsername(){return this.currentUserEmail?this.currentUserEmail.split("@")[0]:""},filteredServers(){let e=this.serversList;if(this.showOnlyFavorites&&(e=e.filter(e=>this.isServerFavorite(e.id))),this.unifiedFilter){const t=this.unifiedFilter.toLowerCase();e=e.filter(e=>!(!e.name||!e.name.toLowerCase().includes(t))||(!(!e.cpuType||!e.cpuType.toLowerCase().includes(t))||(!!(e.attachedDevices&&e.attachedDevices.length&&this.devicesList&&e.attachedDevices.some(e=>{const r=this.devicesList.find(t=>t.id===e);return r&&r.name&&r.name.toLowerCase().includes(t)}))||!!(this.devicesList&&this.devicesList.length&&this.devicesList.some(r=>r.name&&r.name.toLowerCase().includes(t)&&r.attachedServer===e.id)))))}return e=e.filter(e=>"on"===e.status),e.sort((e,t)=>{const r=this.getCpuTypeGroupIndex(e.cpuType),i=this.getCpuTypeGroupIndex(t.cpuType);if(r!==i)return r-i;const s=(e.name||"").toLowerCase(),a=(t.name||"").toLowerCase();return s.localeCompare(a)})},sortedServersList(){return[...this.serversList].sort((e,t)=>{const r=this.getCpuTypeGroupIndex(e.cpuType),i=this.getCpuTypeGroupIndex(t.cpuType);if(r!==i)return r-i;const s=(e.name||"").toLowerCase(),a=(t.name||"").toLowerCase();return s.localeCompare(a)})},serverWeekDays(){const e=[];for(let t=0;t<7;t++){const r=new Date(this.weekStart);r.setDate(r.getDate()+t),e.push({date:r})}return e},axisTimes(){return Array.from({length:24},(e,t)=>t)},startDateChoices(){return this.genDateChoices(this.startDateInput)},endDateChoices(){return this.genDateChoices(this.endDateInput)},startTimeChoices(){const e=this.parseDateTime(this.startDateInput,this.startTimeInput),t=this.parseDateTime(this.endDateInput,this.endTimeInput);if(!e||!t)return[];const r=[];let i=new Date(e.getTime()-108e5);while(i<=t){const e=this.formatHhMmAmPm(i);r.push(e),i=new Date(i.getTime()+18e5)}return r},endTimeChoices(){const e=this.parseDateTime(this.startDateInput,this.startTimeInput),t=this.parseDateTime(this.endDateInput,this.endTimeInput);if(!e||!t)return[];const r=[];let i=new Date(e.getTime());const s=new Date(t.getTime()+108e5);while(i<=s){const e=this.formatHhMmAmPm(i);r.push(e),i=new Date(i.getTime()+18e5)}return r},editStartDateChoices(){return this.editingReservation?this.genDateChoices(this.editingReservation.startDate):[]},editEndDateChoices(){return this.editingReservation?this.genDateChoices(this.editingReservation.endDate):[]},editStartTimeChoices(){if(!this.editingReservation)return[];const e=this.parseDateTime(this.editingReservation.startDate,this.editingReservation.startTime),t=this.parseDateTime(this.editingReservation.endDate,this.editingReservation.endTime);if(!e||!t)return[];const r=[];let i=new Date(e.getTime()-108e5);while(i<=t){const e=this.formatHhMmAmPm(i);r.push(e),i=new Date(i.getTime()+18e5)}return r},editEndTimeChoices(){if(!this.editingReservation)return[];const e=this.parseDateTime(this.editingReservation.startDate,this.editingReservation.startTime),t=this.parseDateTime(this.editingReservation.endDate,this.editingReservation.endTime);if(!e||!t)return[];const r=[];let i=new Date(e.getTime());const s=new Date(t.getTime()+108e5);while(i<=s){const e=this.formatHhMmAmPm(i);r.push(e),i=new Date(i.getTime()+18e5)}return r},hasAdditionalProperties(){return this.activeServer&&Object.keys(this.getAdditionalFields(this.activeServer)).length>0}},methods:{async checkConflictEfficient(e,t,r,i,s=null){try{const a=(0,bt.P)(this.reservationsCollection,(0,bt._M)("server","==",e),(0,bt._M)("start","<",r.toISOString()),(0,bt.My)("start","asc")),n=await(0,bt.GG)(a),o=n.docs.map(e=>({id:e.id,...e.data()}));console.log(`Checking conflicts for ${e}: found ${o.length} potential conflicts`);for(const e of o){if(s&&e.id===s)continue;const a=new Date(e.start),n=new Date(e.end);if(t<n&&r>a){const t=(e.urgency||"").toLowerCase(),r=(i||"").toLowerCase();if("co-run"!==t||"co-run"!==r)return console.log(`Conflict found: ${e.username} (${e.urgency}) vs new (${i})`),!0}}return console.log("No conflicts found"),!1}catch(a){return console.error("Error checking conflicts:",a),this.checkConflictMemory(e,t,r,i,s)}},checkConflictMemory(e,t,r,i,s=null){const a=this.allReservations.filter(t=>t.server===e&&(null===s||t.id!==s));for(const n of a){const e=new Date(n.start),s=new Date(n.end);if(t<s&&r>e){const e=(n.urgency||"").toLowerCase(),t=(i||"").toLowerCase();if("co-run"!==e||"co-run"!==t)return!0}}return!1},async createReservationSafe(e){try{return await(0,bt.c4)(Tt.kA,async t=>{const r=(0,bt.P)(this.reservationsCollection,(0,bt._M)("server","==",e.server),(0,bt._M)("start","<",e.end),(0,bt.My)("start","asc")),i=await(0,bt.GG)(r),s=i.docs.map(e=>({id:e.id,...e.data()})),a=new Date(e.start),n=new Date(e.end),o=(e.urgency||"").toLowerCase();for(const e of s){const t=new Date(e.start),r=new Date(e.end);if(a<r&&n>t){const t=(e.urgency||"").toLowerCase();if("co-run"!==t||"co-run"!==o)throw new Error(`Conflict with reservation by ${e.username} (${e.urgency})`)}}const l=(0,bt.H9)((0,bt.rJ)(Tt.kA,"reservations"));return t.set(l,e),l.id})}catch(t){throw console.error("Transaction failed:",t),t}},toLocalOffsetISOString(e){const t=e.getTimezoneOffset(),r=t>0?"-":"+",i=Math.abs(t),s=Math.floor(i/60),a=i%60,n=e=>e.toString().padStart(2,"0"),o=e.getFullYear(),l=n(e.getMonth()+1),d=n(e.getDate()),c=n(e.getHours()),u=n(e.getMinutes()),v=n(e.getSeconds()),h=n(s),m=n(a);return`${o}-${l}-${d}T${c}:${u}:${v}${r}${h}:${m}`},formatAxisHour(e){return new Date(2e3,0,1,e).toLocaleTimeString("en-US",{hour:"numeric",hour12:!0})},formatMmmDdYyyy(e){return e.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},formatHhMmAmPm(e){return e.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})},formatDayHeader(e){const t=e.toLocaleDateString("en-US",{weekday:"short"}),r=e.toLocaleDateString("en-US",{month:"short",day:"numeric"});return`${t} (${r})`},formatWeekRange(e){const t=this.addDays(e,6),r=e.toLocaleDateString("en-US",{month:"short"}),i=t.toLocaleDateString("en-US",{month:"short"}),s=e.getDate(),a=t.getDate(),n=e.getFullYear(),o=t.getFullYear();return r!==i||n!==o?`${r} ${s}${n!==o?`, ${n}:`:""} - ${i} ${a}, ${o}`:`${r} ${s} - ${a}, ${n}`},getTimeIndicatorStyle(e,t){const r=new Date;if(!this.isSameDay(r,e))return{};const i=r.getHours()+r.getMinutes()/60,s=i/24*100;return"arrow"===t?{position:"absolute",top:"-10px",left:`calc(${s}% - 2.5px)`,width:"0",height:"0",borderLeft:"5px solid transparent",borderRight:"5px solid transparent",borderTop:"10px solid red"}:"line"===t?{position:"absolute",top:"0",bottom:"0",left:`calc(${s}%)`,width:"2px",background:"linear-gradient(to bottom, rgba(220, 53, 69, 0.8), rgba(220, 53, 69, 0.6))",zIndex:5,boxShadow:"0 0 8px rgba(220, 53, 69, 0.4)"}:{}},currentTimeArrowStyle(e){return this.getTimeIndicatorStyle(e,"arrow")},currentTimeLineStyle(e){return this.getTimeIndicatorStyle(e,"line")},addDays(e,t){const r=new Date(e);return r.setDate(r.getDate()+t),r},isSameDay(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()},moveWeek(e){const t=new Date(this.weekStart);t.setDate(t.getDate()+7*e),this.weekStart=t,this.reloadReservations()},reloadReservations(){this.unsubscribeReservations&&this.unsubscribeReservations(),this.loadReservations()},snapHoursTo00_15_30_45(e){let t=Math.round(60*e);const r=Math.floor(t/60);let i=t%60;return i=i>=0&&i<=25?0:i>25&&i<=55?30:60,r+i/60},parseDateTime(e,t){try{if(!e||!t)return null;const r=new Date(e);if("Invalid Date"===r.toString())return null;const i=t.trim().split(" ");if(2!==i.length)return null;const[s,a]=i;let[n,o]=s.split(":").map(Number);if(isNaN(n)||isNaN(o))return null;const l=a.toUpperCase();return"PM"===l&&12!==n&&(n+=12),"AM"===l&&12===n&&(n=0),r.setHours(n,o,0,0),r}catch(r){return console.error("Error parsing date/time:",r),null}},genDateChoices(e){const t=this.parseDateTime(e,"12:00 PM");if(!t)return[];const r=[];for(const i of[-2,-1,0,1,2]){const e=new Date(t);e.setDate(e.getDate()+i),r.push({value:i,label:this.formatMmmDdYyyy(e)})}return r},validateDateTimes(e,t,r,i){const s=this.parseDateTime(e,t),a=this.parseDateTime(r,i);return s&&a?s>=a?{valid:!1,message:"End time must be after start time"}:{valid:!0,start:s,end:a}:(console.warn("Invalid date/time format"),{valid:!1,message:"Invalid date/time format"})},validateTimes(){const e=this.validateDateTimes(this.startDateInput,this.startTimeInput,this.endDateInput,this.endTimeInput);!e.valid&&e.message&&alert(e.message)},validateEditTimes(){if(!this.editingReservation)return;const e=this.validateDateTimes(this.editingReservation.startDate,this.editingReservation.startTime,this.editingReservation.endDate,this.editingReservation.endTime);!e.valid&&e.message&&alert(e.message),this.$forceUpdate()},async updateReservation(e,t=!1){if(!t)return!1;const r=new Date(e.start),i=new Date(e.end);if(await this.checkConflictEfficient(e.server,r,i,e.urgency,e.id))return alert("Conflict: overlapping on the same server, not all open to co-run."),!1;const s=(0,bt.H9)(Tt.kA,"reservations",e.id);try{const t={title:e.title,server:e.server,start:this.toLocalOffsetISOString(r),end:this.toLocalOffsetISOString(i)};return void 0!==e.urgency&&(t.urgency=e.urgency),void 0!==e.note&&(t.note=e.note),await(0,bt.mZ)(s,t),console.log("Updated reservation"),!0}catch(a){return console.error("Error updating reservation:",a),!1}},updateReservationSilent(e){return this.updateReservation(e,!0)},async saveReservation(e=!0){const t=e?this.newReservation:this.editingReservation;if(!t.server||!t.urgency)return void alert("Server and Urgency are required.");if(!Tt.j2.currentUser)return void alert("You must be logged in to create reservations.");if(!this.currentUsername)return void alert("Username is required but not available. Please refresh and try again.");let r,i;if(e){const e=this.validateDateTimes(this.startDateInput,this.startTimeInput,this.endDateInput,this.endTimeInput);if(!e.valid)return void alert(e.message);r=e.start,i=e.end}else{if(r=this.parseDateTime(t.startDate,t.startTime),i=this.parseDateTime(t.endDate,t.endTime),!r||!i)return void alert("Invalid date/time format.");if(r>=i)return void alert("End time must be after start time.")}try{if(e){const e=`${t.server} (${t.urgency})`,s={title:e,start:this.toLocalOffsetISOString(r),end:this.toLocalOffsetISOString(i),server:t.server,urgency:t.urgency,note:t.note||"",username:this.currentUsername};if(!this.currentUsername)throw new Error("Username is required but not available");if(!this.reservationsCollection)throw new Error("Reservations collection is not initialized");const a=await this.createReservationSafe(s);console.log("Safely created reservation with ID:",a),this.showReservationForm=!1,this.dragCreation.active=!1,this.newReservation={start:null,end:null,server:"",urgency:"",note:""},this.startDateInput="",this.startTimeInput="",this.endDateInput="",this.endTimeInput=""}else{if(await this.checkConflictEfficient(t.server,r,i,t.urgency,t.id))return void alert("Conflict: overlapping on the same server, not all open to co-run.");const e=`${t.server} (${t.urgency})`,s=(0,bt.H9)(Tt.kA,"reservations",t.id);await(0,bt.mZ)(s,{title:e,server:t.server,start:this.toLocalOffsetISOString(r),end:this.toLocalOffsetISOString(i),urgency:t.urgency,note:t.note||""}),this.showEditModal=!1,this.editingReservation=null}}catch(s){console.error("=== FIREBASE ERROR DEBUG ==="),console.error(`Error ${e?"creating":"updating"} reservation:`,s),console.error("Error name:",s.name),console.error("Error message:",s.message),console.error("Error code:",s.code),console.error("Error stack:",s.stack),console.error("Full error object:",JSON.stringify(s,Object.getOwnPropertyNames(s))),console.error("Auth status - currentUser:",Tt.j2.currentUser),console.error("Auth status - currentUserEmail:",this.currentUserEmail),console.error("Auth status - currentUsername:",this.currentUsername),s.message&&s.message.includes("Conflict with reservation")?alert(`Reservation conflict: ${s.message.split("Conflict with reservation by ")[1]}. Please choose a different time or make it co-run compatible.`):"permission-denied"===s.code?alert("Permission denied: You may not have the required permissions to create reservations. Please check with your administrator."):"unauthenticated"===s.code?alert("Authentication required: Please log out and log back in, then try again."):s.message&&s.message.includes("400")?alert("Firebase request failed (400): This is likely a permissions or authentication issue. Please try logging out and back in."):alert(`Firebase ${e?"create":"update"} failed: ${s.message}`)}},confirmReservation(){this.saveReservation(!0)},confirmUpdate(){this.saveReservation(!1)},prefillDateTimeInputs(e,t){this.startDateInput=this.formatMmmDdYyyy(e),this.startTimeInput=this.formatHhMmAmPm(e),this.endDateInput=this.formatMmmDdYyyy(t),this.endTimeInput=this.formatHhMmAmPm(t)},applyDateOffsetForDate(e,t){if(!e)return;const r=parseInt(e);if(isNaN(r))return;const i="start"===t?this.parseDateTime(this.startDateInput,"12:00 PM"):this.parseDateTime(this.endDateInput,"12:00 PM");i?(i.setDate(i.getDate()+r),"start"===t?this.startDateInput=this.formatMmmDdYyyy(i):this.endDateInput=this.formatMmmDdYyyy(i)):alert("Invalid date to shift.")},genTimeChoices(e){const t=this.parseDateTime("Jun 01, 2025",e);if(!t)return[];const r=[];for(let i=-720;i<=720;i+=15){const e=new Date(t);e.setMinutes(e.getMinutes()+i);const s=e.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});r.push({value:i,label:`${i} min => ${s}`})}return r},applyTimeOffset(e,t){if(!e)return;const r=parseInt(e);if(isNaN(r))return;const i=this.parseDateTime("Jun 01, 2025","start"===t?this.startTimeInput:this.endTimeInput);if(!i)return void alert("Invalid time to shift.");i.setMinutes(i.getMinutes()+r);const s=i.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});"start"===t?this.startTimeInput=s:this.endTimeInput=s},cancelReservation(){this.showReservationForm=!1,this.dragCreation.active=!1},async confirmDelete(e){if(this.showEditModal=!1,confirm(`Delete reservation '${e.title}'?`))try{const t=(0,bt.H9)(Tt.kA,"reservations",e.id);await(0,bt.kd)(t),console.log("Reservation deleted.")}catch(t){console.error("Error deleting reservation:",t)}this.editingReservation=null},async promptChangePeriod(){this.showEditModal=!1;const e=prompt("Enter new start time (YYYY-MM-DDTHH:MM)",this.editingReservation.start),t=prompt("Enter new end time (YYYY-MM-DDTHH:MM)",this.editingReservation.end);if(e&&t){try{const r=(0,bt.H9)(Tt.kA,"reservations",this.editingReservation.id);await(0,bt.mZ)(r,{start:this.toLocalOffsetISOString(new Date(e)),end:this.toLocalOffsetISOString(new Date(t))}),console.log("server-type changed in local offset.")}catch(r){console.error("Error updating reservation period:",r)}this.editingReservation=null}},cancelEdit(){this.showEditModal=!1,this.editingReservation=null},closeViewModal(){this.showViewModal=!1,this.viewingReservation=null},async loadServers(){try{this.serversList=await Rt._.loadData("servers"),console.log("Loaded servers:",this.serversList.length)}catch(e){console.error("Error loading servers:",e),this.serversList=[]}},loadReservations(){this.reservationsCollection=(0,bt.rJ)(Tt.kA,"reservations");const e=new Date(this.weekStart);e.setHours(0,0,0,0);const t=new Date(e);t.setDate(t.getDate()+7),t.setHours(23,59,59,999);const r=new Date(e);r.setDate(r.getDate()-30),console.log(`Loading reservations for week: ${e.toISOString()} to ${t.toISOString()}`),console.log(`Extended query range: ${r.toISOString()} to ${t.toISOString()}`);const i=(0,bt.P)(this.reservationsCollection,(0,bt._M)("start",">=",r.toISOString()),(0,bt._M)("start","<",t.toISOString()),(0,bt.My)("start","asc"));this.unsubscribeReservations=(0,bt.aQ)(i,r=>{const i=r.docs.map(e=>{const t=e.data(),r=[this.getUrgencyColorClass(t.urgency)];return t.username===this.currentUsername&&r.push("my-reservation"),{id:e.id,title:t.title,start:t.start,end:t.end,server:t.server,urgency:t.urgency,note:t.note,username:t.username,className:r}});this.allReservations=i.filter(r=>{const i=new Date(r.start),s=new Date(r.end);return i<t&&s>e}),console.log(`Filtered ${this.allReservations.length} reservations from ${i.length} total reservations for current week`);const s=new Date;0===s.getDay()&&this.cleanupOldReservations(),console.log("Fetched reservations:",this.allReservations)},e=>console.error("Error fetching reservations:",e))},async cleanupOldReservations(){try{const e=new Date;e.setMonth(e.getMonth()-3);const t=this.allReservations.filter(t=>{const r=new Date(t.end);return r<e});if(t.length>0){console.log(`Found ${t.length} old reservations to delete`);for(const e of t){const t=(0,bt.H9)(Tt.kA,"reservations",e.id);await(0,bt.kd)(t)}console.log(`Successfully deleted ${t.length} old reservations`)}}catch(e){console.error("Error cleaning up old reservations:",e)}},openReservationForm(){this.newReservation={start:null,end:null,server:"",urgency:"",note:""};const e=new Date,t=this.snapHoursTo00_15_30_45(e.getHours()+e.getMinutes()/60),r=new Date(e.getFullYear(),e.getMonth(),e.getDate(),Math.floor(t),Math.round(60*(t-Math.floor(t))),0,0);this.prefillDateTimeInputs(r,new Date(r.getTime()+36e5)),this.showReservationForm=!0},getReservationsForServerAndDay(e,t){return this.allReservations.filter(r=>{if(r.server!==e.name)return!1;const i=new Date(r.start),s=new Date(r.end),a=new Date(t);a.setHours(0,0,0,0);const n=new Date(t);return n.setHours(23,59,59,999),i<=n&&s>a})},getReservationStyle(e,t){const r=new Date(e.start),i=new Date(e.end),s=new Date(t);s.setHours(0,0,0,0);const a=new Date(t);a.setHours(24,0,0,0);const n=r<s?s:r,o=i>a?a:i,l=n.getHours()+n.getMinutes()/60;let d=o.getHours()+o.getMinutes()/60;(o.getTime()>=a.getTime()||0===d&&o>s)&&(d=24);const c=l/24*100,u=(d-l)/24*100;return r.getMonth()===i.getMonth()&&r.getDate()===i.getDate()||console.log("Cross-date reservation debugging:",{username:e.username,server:e.server,originalStart:e.start,originalEnd:e.end,viewingDay:t.toDateString(),effectiveStart:n.toISOString(),effectiveEnd:o.toISOString(),startHour:l,endHour:d,leftPercent:c,widthPercent:u}),{left:`${c}%`,width:`${u}%`}},handleReservationClick(e){const t=this.formatMmmDdYyyy(new Date(e.start)),r=this.formatHhMmAmPm(new Date(e.start)),i=this.formatMmmDdYyyy(new Date(e.end)),s=this.formatHhMmAmPm(new Date(e.end)),a={...e,startDate:t,startTime:r,endDate:i,endTime:s};e.username===this.currentUsername?(this.editingReservation=null,this.$nextTick(()=>{this.editingReservation=a,this.showEditModal=!0})):(this.viewingReservation=null,this.$nextTick(()=>{this.viewingReservation=a,this.showViewModal=!0}))},handleTimelineContainerMousedown(e,t){t.target.closest(".reservation")||(t.preventDefault(),this.startDragCreation(null,e,t))},handleReservationContainerMousedown(e,t,r){r.target.closest(".reservation")||(r.preventDefault(),this.startDragCreation(e,t,r))},startDragCreation(e,t,r){const i=r.currentTarget.getBoundingClientRect();this.dragCreation={active:!0,server:e,day:t,startX:r.clientX,currentX:r.clientX,containerLeft:i.left,containerWidth:i.width},window.addEventListener("mousemove",this.onDragCreationMove),window.addEventListener("mouseup",this.onDragCreationEnd)},onDragCreationMove(e){if(!this.dragCreation.active)return;const{startX:t,containerLeft:r,containerWidth:i}=this.dragCreation,s=e.clientX-r,a=t-r;let n=a/i,o=s/i,l=24*n,d=24*o;l=this.snapHoursTo00_15_30_45(l),d=this.snapHoursTo00_15_30_45(d);const c=l/24*i,u=d/24*i,v=Math.min(c,u),h=Math.max(c,u),m=h-v;this.dragCreation.currentX=e.clientX,this.dragCreation.previewLeft=v,this.dragCreation.previewWidth=m,this.dragCreation.snappedStartPx=v,this.dragCreation.snappedEndPx=h},onDragCreationEnd(){if(!this.dragCreation.active)return;window.removeEventListener("mousemove",this.onDragCreationMove),window.removeEventListener("mouseup",this.onDragCreationEnd);const{startX:e,currentX:t,snappedStartPx:r,snappedEndPx:i,containerLeft:s,containerWidth:a,day:n,server:o}=this.dragCreation,l=Math.min(r,i),d=Math.max(r,i),c=l/a,u=d/a;if(e-t<3&&t-e<3){let t=e-s,r=t/a,i=24*r;i=this.snapHoursTo00_15_30_45(i);const l=new Date(n);l.setHours(Math.floor(i),Math.round(60*(i-Math.floor(i))),0,0);const d=new Date(l.getTime()+18e5),c=i/24*a;this.dragCreation.previewLeft=c,this.dragCreation.previewWidth=.5/24*a,this.newReservation.server=o?o.name:"",this.newReservation.start=l,this.newReservation.end=d,this.newReservation.urgency="",this.newReservation.note="",this.prefillDateTimeInputs(l,d),this.showReservationForm=!0}else{let e=24*c,t=24*u;e=this.snapHoursTo00_15_30_45(e),t=this.snapHoursTo00_15_30_45(t);const r=new Date(n);r.setHours(Math.floor(e),Math.round(60*(e-Math.floor(e))),0,0);const i=new Date(n);i.setHours(Math.floor(t),Math.round(60*(t-Math.floor(t))),0,0),this.newReservation.server=o?o.name:"",this.newReservation.start=r,this.newReservation.end=i,this.newReservation.urgency="",this.newReservation.note="",this.prefillDateTimeInputs(r,i),this.showReservationForm=!0}},getDragPreviewStyle(){if(!this.dragCreation.active)return{};if(null==this.dragCreation.previewLeft||null==this.dragCreation.previewWidth){let e=Math.min(this.dragCreation.startX,this.dragCreation.currentX)-this.dragCreation.containerLeft;e<0&&(e=0);const t=Math.abs(this.dragCreation.currentX-this.dragCreation.startX);return{left:e+"px",width:t+"px"}}return{left:this.dragCreation.previewLeft+"px",width:this.dragCreation.previewWidth+"px"}},handleDragOver(e,t,r){if(!this.draggedReservation)return;e.preventDefault();const i=e.currentTarget.getBoundingClientRect(),s=e.clientX-i.left;let a=s/i.width,n=24*a;n=this.snapHoursTo00_15_30_45(n);const o=new Date(this.draggedReservation.start),l=new Date(this.draggedReservation.end),d=(l-o)/36e5,c=n/24*100,u=d/24*100;this.dragPreviewPosition={active:!0,server:t,day:r,left:c,width:u,serverIndex:this.filteredServers.findIndex(e=>e.id===t.id)}},isDraggingOver(e,t){return this.dragPreviewPosition.active&&this.dragPreviewPosition.server.id===e.id&&this.isSameDay(this.dragPreviewPosition.day,t)},getDragGridPreviewStyle(){return this.dragPreviewPosition.active?{left:`${this.dragPreviewPosition.left}%`,width:`${this.dragPreviewPosition.width}%`,top:"5px",height:"25px"}:{}},async onDrop(e,t,r){if(!this.draggedReservation)return;if(this.draggedReservation.username!==this.currentUsername)return alert("You can only modify your own reservations."),this.draggedReservation=null,this.draggedOriginalServer=null,void(this.dragPreviewPosition.active=!1);const i=e.currentTarget.getBoundingClientRect(),s=e.clientX-i.left;let a=s/i.width,n=24*a;n=this.snapHoursTo00_15_30_45(n);const o=new Date(r);o.setHours(Math.floor(n),Math.round(60*(n-Math.floor(n))),0,0);const l=new Date(this.draggedReservation.start),d=new Date(this.draggedReservation.end),c=d-l,u=new Date(o.getTime()+c);if(await this.checkConflictEfficient(t.name,o,u,this.draggedReservation.urgency,this.draggedReservation.id))return void alert("Conflict: overlapping on the same server, not all open to co-run.");const v=`${t.name} (${this.draggedReservation.urgency})`,h={...this.draggedReservation,title:v,server:t.name,start:this.toLocalOffsetISOString(o),end:this.toLocalOffsetISOString(u)};this.updateReservation(h,!0),this.draggedReservation=null,this.draggedOriginalServer=null,this.dragPreviewPosition.active=!1},startCustomDrag(e,t,r,i){if(i.preventDefault(),i.stopPropagation(),e.username!==this.currentUsername)return void this.handleReservationClick(e);const s=i.currentTarget,a=s.getBoundingClientRect(),n=new Date(e.start),o=new Date(e.end),l=(o-n)/36e5;this.customDragInitialOffset=i.clientX-a.left,this.customDragActive=!0,this.customDragReservation=e,this.customDragStartServer=t,this.customDragCurrentServer=t,this.customDragDay=r,this.customDragWidth=l,this.customDragInitialRect=a,this.customDragStartTime=n,console.log("[Drag Start] Server:",t.name,"Day:",this.formatMmmDdYyyy(r)),this.isDragging=!1,this.dragStartX=i.clientX,this.dragStartY=i.clientY,this.customDragPreviewStyle={position:"fixed",left:`${a.left}px`,top:`${a.top}px`,width:`${a.width}px`,height:`${a.height}px`,background:"rgba(255, 165, 0, 0.7)",border:"2px dashed #ff8c00",zIndex:9999,pointerEvents:"none",borderRadius:"3px",boxShadow:"0 2px 5px rgba(0,0,0,0.3)",display:"block",transition:"top 0.1s ease-out"},window.addEventListener("mousemove",this.handleCustomDragMove),window.addEventListener("mouseup",this.handleCustomDragEnd),this.lastMouseX=i.clientX,this.lastMouseY=i.clientY},handleCustomDragMove(e){if(!this.customDragActive)return;const t=Math.abs(e.clientX-this.dragStartX),r=Math.abs(e.clientY-this.dragStartY);!this.isDragging&&(t>this.dragThreshold||r>this.dragThreshold)&&(this.isDragging=!0,console.log("Dragging started"));const i=document.querySelectorAll(".day-section");let s=null,a=null,n=null,o=1/0;if(i.forEach((t,r)=>{const i=t.querySelector(".timeline");if(i){const t=i.getBoundingClientRect();if(e.clientX>=t.left&&e.clientX<=t.right){const l=e.clientY-t.top,d=Math.floor(l/this.rowHeight);if(d>=0&&d<this.filteredServers.length){const l=t.top+d*this.rowHeight,c=l+this.rowHeight,u=Math.min(Math.abs(e.clientY-l),Math.abs(e.clientY-c));u<o&&(o=u,s=i,a=this.serverWeekDays[r].date,n=this.filteredServers[d])}}}}),s&&n){const t=s.getBoundingClientRect();let r=e.clientX-t.left;r<0&&(r=0),r>t.width&&(r=t.width);const i=r/t.width;let o=24*i;o=this.snapHoursTo00_15_30_45(o);const l=this.filteredServers.findIndex(e=>e.id===n.id),d=o/24,c=t.left+d*t.width,u=t.top+(l>=0?l*this.rowHeight:0)+5,v=this.customDragWidth*t.width/24;this.customDragPreviewStyle={...this.customDragPreviewStyle,left:`${c}px`,top:`${u}px`,width:`${v}px`,height:"25px",transition:"top 0.1s ease-out"},this.customDragCurrentServer===n&&this.isSameDay(this.customDragDay,a)||(console.log("[Drag Move] Changing to:","Server:",n.name,"Day:",this.formatMmmDdYyyy(a)),this.customDragCurrentServer=n,this.customDragDay=a)}this.lastMouseX=e.clientX,this.lastMouseY=e.clientY},async handleCustomDragEnd(){if(!this.customDragActive)return;if(window.removeEventListener("mousemove",this.handleCustomDragMove),window.removeEventListener("mouseup",this.handleCustomDragEnd),this.customDragReservation&&this.customDragReservation.username!==this.currentUsername)return this.customDragActive=!1,this.customDragReservation=null,this.customDragStartServer=null,this.customDragCurrentServer=null,this.customDragDay=null,this.isDragging=!1,this.customDragInitialRect=null,void alert("You can only modify your own reservations.");const e=Math.sqrt(Math.pow(this.lastMouseX-this.dragStartX,2)+Math.pow(this.lastMouseY-this.dragStartY,2));if(e<=1*this.dragThreshold)this.handleReservationClick(this.customDragReservation);else if(this.isDragging&&this.customDragReservation&&this.customDragDay&&this.customDragCurrentServer){console.log("[Drag End] Final position:","Server:",this.customDragCurrentServer.name,"Day:",this.formatMmmDdYyyy(this.customDragDay));const t=this.serverWeekDays.findIndex(e=>this.isSameDay(e.date,this.customDragDay)),r=this.filteredServers.findIndex(e=>e.id===this.customDragCurrentServer.id);if(t>=0&&r>=0){const r=document.querySelectorAll(".day-section");if(t<r.length){const i=r[t].querySelector(".timeline");if(i){const t=i.getBoundingClientRect();let r=this.lastMouseX-t.left;r<0&&(r=0),r>t.width&&(r=t.width);const s=r/t.width;let a=24*s;a=this.snapHoursTo00_15_30_45(a);const n=new Date(this.customDragDay);n.setHours(Math.floor(a),Math.round(60*(a-Math.floor(a))),0,0);const o=new Date(this.customDragReservation.start),l=new Date(this.customDragReservation.end),d=l-o,c=new Date(n.getTime()+d);if(await this.checkConflictEfficient(this.customDragCurrentServer.name,n,c,this.customDragReservation.urgency,this.customDragReservation.id))return alert("Conflict: overlapping on the same server, not all open to co-run."),this.customDragActive=!1,this.customDragReservation=null,this.customDragStartServer=null,this.customDragCurrentServer=null,this.customDragDay=null,this.isDragging=!1,void(this.customDragInitialRect=null);const u=`${this.customDragCurrentServer.name} (${this.customDragReservation.urgency})`,v={...this.customDragReservation,title:u,server:this.customDragCurrentServer.name,start:this.toLocalOffsetISOString(n),end:this.toLocalOffsetISOString(c)},h=e>4*this.dragThreshold;h?this.updateReservationSilent(v):(this.editingReservation=null,this.$nextTick(()=>{this.editingReservation={...v,startDate:this.formatMmmDdYyyy(n),startTime:this.formatHhMmAmPm(n),endDate:this.formatMmmDdYyyy(c),endTime:this.formatHhMmAmPm(c)},this.showEditModal=!0}))}}}}this.customDragActive=!1,this.customDragReservation=null,this.customDragStartServer=null,this.customDragCurrentServer=null,this.customDragDay=null,this.isDragging=!1,this.customDragInitialRect=null},formatTimeRange(e,t){const r=e.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),i=t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return`${r} - ${i}`},isMyReservation(e){return e.username===this.currentUsername},serverHasAttachedDeviceMatchingFilter(e,t){return!(!e.attachedDevices||!e.attachedDevices.length)&&e.attachedDevices.some(e=>{const r=this.devicesList.find(t=>t.id===e);return r&&r.name&&r.name.toLowerCase().includes(t)})},async loadDevices(){try{return this.devicesList=await Rt._.loadData("devices"),console.log("Loaded devices:",this.devicesList.length),this.devicesList}catch(e){return console.error("Error loading devices:",e),this.devicesList=[],[]}},getUrgencyColorClass(e){if(!e)return"urgency-default";const t=e.toLowerCase();return t.includes("co-run")?"urgency-corun":t.includes("may yield")?"urgency-exclusive-light":t.includes("urgent")?"urgency-exclusive-dark":"urgency-exclusive-medium"},clearAllFilters(){this.unifiedFilter="",this.serverFilter="",this.deviceFilter="",this.showOnlyFavorites=!1,(this.$route.query.server||this.$route.query.device)&&this.$router.replace({path:this.$route.path})},formatIp(e){return e?Array.isArray(e)?e.join(", "):e:"N/A"},formatStatus(e){return e?e.charAt(0).toUpperCase()+e.slice(1):"Unknown"},getStatusColor(e){return e&&"on"===e.toLowerCase()?"status-green":"status-red"},formatFieldName(e){return e.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase())},parseBmcIps(e){return e?e.split(",").map(e=>e.trim()).filter(e=>e.length>0):[]},isPasswordVisible(e){return this.visiblePasswords.has(e)},togglePasswordVisibility(e){this.visiblePasswords.has(e)?this.visiblePasswords.delete(e):(this.visiblePasswords.add(e),setTimeout(()=>{this.visiblePasswords.delete(e),this.$forceUpdate()},5e3))},hasViewPermissions(){return(0,Tt.qc)()||(0,Tt.QY)()},showServerDetails(e){this.activeServer=e,this.serverAttachedDevices=[],e.attachedDevices&&e.attachedDevices.length&&(this.serverAttachedDevices=e.attachedDevices.map(e=>{const t=this.devicesList.find(t=>t.id===e);return t||{id:e,name:"Unknown Device"}})),this.showServerDetailsModal=!0},closeServerDetails(){this.showServerDetailsModal=!1,this.activeServer=null,this.serverAttachedDevices=[],this.visiblePasswords.clear()},reserveActiveServer(){this.activeServer&&(this.$router.push({path:"/calendar",query:{server:this.activeServer.name}}),this.unifiedFilter=this.activeServer.name,this.closeServerDetails())},getAdditionalFields(e){if(!e)return{};const t=["id","name","cpuType","ip","owner","sudoUser","sudoUserPassword","status","location","attachedDevices","cpuFreq","memorySlots","dimmType","numDimms","bmcIp","bmcUser","bmcPassword","ubuntuVersion"];return Object.fromEntries(Object.entries(e).filter(([e,r])=>!t.includes(e)&&null!==r&&void 0!==r&&""!==r&&!(Array.isArray(r)&&0===r.length)&&!e.toLowerCase().includes("transfer")))},getCpuTypeGroupIndex(e){if(!e)return 999;const t=e.toLowerCase();return t.includes("spr")||t.includes("emr")||t.includes("gnr")?0:t.includes("skx")||t.includes("icx")||t.includes("skl")?1:t.includes("epyc")?2:t.includes("hsw")||t.includes("bdw")||t.includes("haswell")||t.includes("broadwell")?3:4},isServerFavorite(e){return this.favoriteServers.has(e)},async loadFavorites(){if(this.currentUserEmail)try{const e=(0,bt.rJ)(Tt.kA,"authorizedUsers"),t=(0,bt.P)(e,(0,bt._M)("email","==",this.currentUserEmail));(0,bt.aQ)(t,e=>{if(!e.empty){const t=e.docs[0];this.userDocId=t.id;const r=t.data();r&&r.favorite_servers?this.favoriteServers=new Set(r.favorite_servers):this.favoriteServers=new Set}})}catch(e){console.error("Error loading favorites:",e)}}},watch:{startDateInput(){this.startTimeChoices,this.endTimeChoices},startTimeInput(){this.startTimeChoices,this.endTimeChoices},endDateInput(){this.startTimeChoices,this.endTimeChoices},endTimeInput(){this.startTimeChoices,this.endTimeChoices},"editingReservation.startDate"(){this.editingReservation&&this.validateEditTimes()},"editingReservation.startTime"(){this.editingReservation&&this.validateEditTimes()},"editingReservation.endDate"(){this.editingReservation&&this.validateEditTimes()},"editingReservation.endTime"(){this.editingReservation&&this.validateEditTimes()},showEditModal(e){e&&this.editingReservation&&this.$nextTick(()=>{this.validateEditTimes()})},"$route.query"(e){e.server?(this.unifiedFilter=e.server,this.selectedViewType="server"):e.device&&(this.unifiedFilter=e.device)}},mounted(){Rt._.cleanupOldCache(),this.currentUserEmail&&this.loadFavorites()},created(){this.weekStart=new Date,this.loadServers(),this.loadReservations(),this.loadDevices().then(()=>{const e=this.$route.query.server,t=this.$route.query.device;e?this.unifiedFilter=e:t&&(this.unifiedFilter=t)}),Tt.j2.onAuthStateChanged(async e=>{e?(this.userRole=await(0,Tt.uG)(),this.loadFavorites()):(this.userRole="guest",this.favoriteServers=new Set)})},beforeUnmount(){this.customDragActive&&(window.removeEventListener("mousemove",this.handleCustomDragMove),window.removeEventListener("mouseup",this.handleCustomDragEnd),this.dragAnimationFrame&&cancelAnimationFrame(this.dragAnimationFrame)),this.unsubscribeReservations&&this.unsubscribeReservations()}},Mt=r(1241);const It=(0,Mt.A)(Et,[["render",St]]);var Ut=It}}]);
//# sourceMappingURL=791.1c1a8f45.js.map